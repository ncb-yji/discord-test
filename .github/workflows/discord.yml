- name: Send notification to Discord
  env:
    DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
  run: |
    BRANCH_NAME=$(echo "${GITHUB_REF#refs/heads/}")
    AUTHOR="${{ github.actor }}"
    COMMIT_MESSAGE=$(git log -1 --pretty=format:"%s")
    COMMIT_SHA=$(git rev-parse --short HEAD)

    # GitHub ID â†’ ë‹‰ë„¤ì„ ë§¤í•‘
    case "$AUTHOR" in
      ncb-yji) NICKNAME="ì–‘ì •ì¸" ;;
      leehj7739) NICKNAME="ì´í¬ì¤€" ;;
      jihun-01) NICKNAME="ìµœì§€í›ˆ" ;;
      naGGuri) NICKNAME="ë‚˜í¬ìˆ˜" ;;
      hyeonjinleeluck) NICKNAME="ì´í˜„ì§„" ;;
      *) NICKNAME="$AUTHOR" ;;
    esac

    # Merge ê°ì§€ (branch merge or PR merge ëª¨ë‘ í¬í•¨)
    if echo "$COMMIT_MESSAGE" | grep -Eq "^Merge (branch|pull request)"; then
      MESSAGE="ğŸ”€ **MERGE Detected**\nğŸ‘¤ ì‘ì„±ì: \`$NICKNAME\`\nğŸŒ¿ ë¸Œëœì¹˜: \`$BRANCH_NAME\`\nğŸ’¬ ë©”ì‹œì§€: \`$COMMIT_MESSAGE\`\nğŸ”¢ Hash: \`$COMMIT_SHA\`"
    else
      MESSAGE="ğŸ“Œ **PUSH : \`$BRANCH_NAME\`**\n- ì‘ì„±ì: \`$NICKNAME\`\n- ë©”ì‹œì§€: \`$COMMIT_MESSAGE\`\n- Hash: \`$COMMIT_SHA\`"
    fi

    curl -H "Content-Type: application/json" \
         -X POST \
         -d "{\"content\": \"$MESSAGE\", \"username\": \"PushBot-$COMMIT_SHA\"}" \
         "$DISCORD_WEBHOOK"
